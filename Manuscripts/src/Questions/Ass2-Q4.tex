\item \textbf{Finally, repeat the analysis in 3 but for a VAR-based approach. Explore the relationships between the chosen variables using appropriate tools. Again, there is no fixed number of variables assigned â€“ use your judgement and justify your decisions.  Using a VAR framework, show the impact of including additional variables in your prediction. Repeat the analysis in 2 (a) and (b) using the updated models.} 

\textit{Likewise the last question, we visualized the first nine signals to see what kind of data we have.} 

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{figures/Ass2/Ass2_Q3_raw_signal.png}
    \end{minipage}
    \caption{The visualization of the first nine columns.}
    \label{fig:Ass2_Q4_raw_signal}
\end{figure}


\textit{Then, we needed to find out which variables must choose for VAR, so that we applied two tools, Granger causality and Johanson's Cointegration test. Granger causality test implemented over the first 20 variables. Then we used the second test on variables that were Granger causes. Tables \ref{tab:Ass2_Q4_Granger_results1} and \ref{tab:Ass2_Q4_coin} show the results of these two tests.
Based on these tests, signals mom, mom1, ROC\_X and EMA\_X had a relation with the target variable ("Close price"). We stored these variables for the next steps.}

\begin{table}[H]
\centering
\caption{The result of Granger causality test.}
\label{tab:Ass2_Q4_Granger_results1}
\input{manuscript/src/tables/Ass2/Ass2_Q4_Granger_results1}
\end{table}


\begin{table}[H]
\centering
\caption{The result of Johanson's Cointegration test.}
\label{tab:Ass2_Q4_coin}
\input{manuscript/src/tables/Ass2/Ass2_Q4_coin}
\end{table}


\textit{As figure \ref{fig:Ass2_Q4_raw_signal} shown, signals had a different range. Therefore, we standardized all data to have the same scale. Figure \ref{fig:Ass2_Q4_standard_data} indicates the standardized variables. Also, we applied \gls{ADF} on these signals to find out which were stationary or non-stationary. Table \ref{tab:Ass2_Q4_ADF_results} shows the result of this test on the dataset.}

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{figures/Ass2/Ass2_Q4_standard_data.png}
    \end{minipage}
    \caption{The visualization of the first twelve columns. Columns were standardized.}
    \label{fig:Ass2_Q4_standard_data}
\end{figure}


\begin{table}[H]
\centering
\caption{The result of the \gls{ADF} on the dataset.}
\label{tab:Ass2_Q4_ADF_results}
\input{manuscript/src/tables/Ass2/Ass2_Q4_ADF_results1}
\end{table}

\textit{According to table \ref{tab:Ass2_Q4_ADF_results}, all columns were stationary except "Close price" and EMA\_X variables.  
We used a first-order differencing to turn these time series into the stationary data. Figures \ref{fig:Ass2_Q4_1diff_Close_signal} and \ref{fig:Ass2_Q4_PACF_ACF_1diff} indicate this $1^{st}$ order differencing for the "Close price" signal along with its \gls{ACF} and \gls{PACF} plots. These two plots also show that the data got stationary. Table \ref{tab:Ass2_Q4_ADF_results2} shows the ADF test on the $1^{st}$ order differencing variables.}

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{figures/Ass2/Ass2_Q4_1diff_Close_signal.png}
    \end{minipage}
    \caption{The $1^{st}$ order differencing of "Close price" data.}
    \label{fig:Ass2_Q4_1diff_Close_signal}
\end{figure}

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{figures/Ass2/Ass2_Q3_PACF_ACF_1diff.png}
    \end{minipage}
    \caption{A plot of \gls{ACF} and \gls{PACF} on the $1^{st}$ order differencing in "Close price".}
    \label{fig:Ass2_Q4_PACF_ACF_1diff}
\end{figure}

\begin{table}[H]
\centering
\caption{The result of the \gls{ADF} on the $1^{st}$ order differencing variables.}
\label{tab:Ass2_Q4_ADF_results2}
\input{manuscript/src/tables/Ass2/Ass2_Q4_ADF_results2}
\end{table}


\textit{After transforming and making stationary, we needed to find the best-fitted model. Thus we searched on various orders. For the searching area, we used all lags between 1 and 50. Figure \ref{fig:Ass2_Q4_AIC_plot} shows the \gls{AIC} over the different orders. The best order in terms of \gls{AIC} belonged to order 9 (VAR(9) model). We could do the same procedure to find the best order based on other information criteria. The below table shows the result of other information criteria.}

\begin{table}[H]
\centering
\caption{The result of other information criteria.}
\label{tab:Ass2_Q4_criteria}
\input{manuscript/src/tables/Ass2/Ass2_Q4_criteria}
\end{table}


\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{manuscript/src/figures/Ass2/Ass2_Q4_AIC_plot.png}
    \end{minipage}
    \caption{The \gls{AIC} over the different orders of VAR model.}
    \label{fig:Ass2_Q4_AIC_plot}
\end{figure}

\textit{Figure \ref{fig:Ass2_Q4_residual_plot} indicates the residual of the fitted model only for the first variable. As this plot illustrates, the residual signal of the model had a Gaussian distribution with zero mean. Besides, the \gls{ACF} plot shows that this signal was stationary.}



\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.8\textwidth}
        \includegraphics[width=\textwidth]{manuscript/src/figures/Ass2/Ass2_Q4_residual_plot.png}
    \end{minipage}
    \caption{The residual of the fitted model.}
    \label{fig:Ass2_Q4_residual_plot}
\end{figure}


\textit{In addition, we applied the Durbin Watson test to estimate the correlation between residuals. This correlation shows whether or not the pattern has any leftover in the residuals. As table \ref{tab:Ass2_Q4_DW_results} indicates Durbin Watson's results were close to 2. It means there was no correlation between residuals. } 

\begin{table}[H]
\centering
\caption{The result of Durbin Watson test on the dataset.}
\label{tab:Ass2_Q4_DW_results}
\input{manuscript/src/tables/Ass2/Ass2_Q4_DW_results}
\end{table}




\textit{To forecast, we split data into test and train set like the last two parts. After prediction, we reversed differencing and standardization to get the real forecast. Figure \ref{fig:Ass2_Q4_Forecast_vs_Actuals_of_close} demonstrates the output of the fitted model only for "Close price." As can be seen, although the model could predict perfectly at the first, it got a flat slope. The RMS error for this model was 339.599.} 


\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=.9\textwidth]{manuscript/src/figures/Ass2/Ass2_Q4_Forecast_vs_Actuals_of_close.png}
    \end{minipage}
    \caption{The prediction and actual data of VAR model.}
    \label{fig:Ass2_Q4_Forecast_vs_Actuals_of_close}
\end{figure}




\textit{For the rolling window approach, we used the same procedure in question 2. Figure \ref{fig:Ass2_Q4_Rolling_Forecast_vs_Actuals_of_close} demonstrates the output of the rolling window model for VAR. As can be seen, the model could follow the test set better than the previous models. The RMS error decreased from 339.599 to 117.565.}


\begin{figure}[H]
    \centering
    \begin{minipage}[b]{1\textwidth}
        \includegraphics[width=\textwidth]{manuscript/src/figures/Ass2/Ass2_Q4_Rolling_Forecast_vs_Actuals_of_close.png}
    \end{minipage}
    \caption{The prediction and actual data of VAR model.}
    \label{fig:Ass2_Q4_Rolling_Forecast_vs_Actuals_of_close}
\end{figure}